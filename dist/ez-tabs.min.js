angular.module("ez.tabs",[]).constant("EzTabsConfig",{preSelectPromise:null,lazy:!0,initialTabIndex:0}).directive("tabset",["$templateCache","$compile","$parse","EzTabsConfig",function(a,b,c,d){return{restrict:"E",scope:{config:"=?",tabIndex:"=?",initialTabIndex:"=?"},compile:function(e,f){var g,h,i,j,k,l=e.find("tab").remove(),m=[],n=angular.element('<div><ul class="nav nav-tabs"></ul><div class="tab-content"></div></div>');for(var o in f.$attr)"config"!==o&&"tabIndex"!==o&&n.attr(o,f[o]);return n.addClass("ez-tabs"),i=n.find("ul.nav-tabs"),j=n.find(".tab-content"),l.each(function(a){h=angular.element('<li data-index="'+a+'"><a>'+l[a].children[0].innerHTML+"</a></li>"),g=angular.element('<div data-index="'+a+'" class="tab-pane"><div class="tab-pane-content"></div></div>'),k=l[a].attributes;for(var b=0;b<k.length;b++)h.find("a").attr(k[b].nodeName,k[b].value),g.find(".tab-pane-content").attr(k[b].nodeName,k[b].value);m.push({src:l[a].children[1].getAttribute("src"),rawHtml:l[a].children[1].innerHTML,lazy:l[a].getAttribute("lazy")}),i.append(h),j.append(g)}),function(e,f,g){var h,k,l;e.tabs=m,e.options=angular.extend({},d,e.config),e.initialTabIndex=e.initialTabIndex||e.options.initialTabIndex,"false"===g.lazy&&(e.options.lazy=!1),i.on("click","a",function(){e.select($(this).parent().data("index")),e.$apply()});var o=function(c){h=e.tabs[c],k=h.src?a.get(h.src):h.rawHtml,n.find('.tab-pane[data-index="'+c+'"]').html(k),b(n.find('.tab-pane[data-index="'+c+'"]'))(e.$parent),h.compiled=!0};l=function(a){h=e.tabs[a],h.compiled||o(a),i.find(".active").removeClass("active"),j.find(".tab-pane.active").removeClass("active"),j.find('.tab-pane[data-index="'+a+'"]').addClass("active"),i.find('li[data-index="'+a+'"]').addClass("active"),e.$parent.$broadcast("ez_tabs.selected",a),e.tabIndex=a},e.select=function(a){e.options.preSelectPromise?e.options.preSelectPromise(e.tabs[a],n,a).then(function(){l(a)}):l(a)},f.replaceWith(n),b(n)(e.$parent);for(var p=0,q=m.length;q>p;p++)(e.options.lazy===!1||null!==m[p].lazy&&("false"===m[p].lazy||c(m[p].lazy)(e.$parent)===!1))&&o(p);l(e.initialTabIndex)}}}}]);