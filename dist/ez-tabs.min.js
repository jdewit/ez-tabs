angular.module("ez.tabs",[]).constant("EzTabsConfig",{preSelectPromise:null,lazy:!0}).directive("tabset",["$templateCache","$compile","$parse","EzTabsConfig",function(a,b,c,d){return{restrict:"E",scope:{config:"=?",tabIndex:"=?"},compile:function(e,f){var g,h,i,j,k,l=e.find("tab").remove(),m=[],n=angular.element('<div><ul class="nav nav-tabs"></ul><div class="tab-content"></div></div>');for(var o in f.$attr)"config"!==o&&"tabIndex"!==o&&n.attr(o,f[o]);return n.addClass("ez-tabs"),i=n.find("ul"),j=n.find(".tab-content"),l.each(function(a){h=angular.element('<li data-index="'+a+'"><a>'+l[a].children[0].innerHTML+"</a></li>"),g=angular.element('<div data-index="'+a+'" class="tab-pane"><div class="tab-pane-content"></div></div>'),k=l[a].attributes;for(var b=0;b<k.length;b++)h.find("a").attr(k[b].nodeName,k[b].value),g.find(".tab-pane-content").attr(k[b].nodeName,k[b].value);m.push({src:l[a].children[1].getAttribute("src"),rawHtml:l[a].children[1].innerHTML,lazy:l[a].getAttribute("lazy")}),i.append(h),j.append(g)}),function(e,f,g){var h,i,j;e.tabs=m,e.options=angular.extend({},d,e.config),"false"===g.lazy&&(e.options.lazy=!1),n.find(".nav.nav-tabs").on("click","a",function(){e.select($(this).parent().data("index")),e.$apply()});var k=function(c){h=e.tabs[c],i=h.src?a.get(h.src):h.rawHtml,n.find('.tab-pane[data-index="'+c+'"]').html(i),b(n.find('.tab-pane[data-index="'+c+'"]'))(e.$parent),h.compiled=!0};j=function(a){h=e.tabs[a],h.compiled||k(a),n.find(".active").removeClass("active"),n.find('.tab-pane[data-index="'+a+'"]').addClass("active"),n.find('li[data-index="'+a+'"]').addClass("active"),e.$parent.$broadcast("ez_tabs.selected",a),e.tabIndex=a},e.select=function(a){e.options.preSelectPromise?e.options.preSelectPromise(e.tabs[a],n,a).then(function(){j(a)}):j(a)},f.replaceWith(n),b(n)(e.$parent);for(var l=0,o=m.length;o>l;l++)(e.options.lazy===!1||null!==m[l].lazy&&("false"===m[l].lazy||c(m[l].lazy)(e.$parent)===!1))&&k(l);j(0)}}}}]);